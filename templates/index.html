<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bangalore House Price Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px 0;
        }
        .prediction-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="prediction-card p-5">
                    <h1 class="text-center mb-4 text-primary">Welcome to Bangalore House Price Prediction</h1> 
                    
                    {# Show model status warning #}
                    {% if not model_loaded %}
                        <div class="alert alert-warning" role="alert">
                            <h4 class="alert-heading">‚ö†Ô∏è Warning</h4>
                            <p>Machine learning model is not loaded properly. Please check the console.</p>
                        </div>
                    {% endif %}
                    
                    {# Show prediction result #}
                    {% if prediction %}
                        <div class="alert alert-success" role="alert">
                            <h4 class="alert-heading">üéâ Prediction Result</h4>
                            <p class="mb-0">The estimated price for your house is: <strong>‚Çπ{{ prediction }} Lakhs</strong></p>
                        </div>
                        
                        {# Clear button when prediction is shown #}
                        <div class="text-center mb-4">
                            <a href="{{ url_for('clear_form') }}" class="btn btn-secondary">üîÑ Make Another Prediction</a>
                        </div>
                    {% endif %}
                    
                    {# Show error messages #}
                    {% if error %}
                        <div class="alert alert-danger" role="alert">
                            <h4 class="alert-heading">‚ùå Error</h4>
                            <p class="mb-0">{{ error }}</p>
                        </div>
                    {% endif %}
                    
                    {# Prediction Form #}
                    <form method="POST" action="{{ url_for('predict') }}" id="predictionForm">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="location" class="form-label"><strong>Select the location:</strong></label>
                                <select class="form-control" name="location" id="location" required>
                                    <option value="">Choose a location...</option>
                                    {% for location in locations %}
                                        <option value="{{ location }}" 
                                            {% if selected_location == location %}selected{% endif %}>
                                            {{ location }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="bhk" class="form-label"><strong>Enter BHK:</strong></label>
                                <input type="number" 
                                       name="bhk" 
                                       id="bhk" 
                                       class="form-control" 
                                       placeholder="Enter BHK (e.g., 2, 3, 4)" 
                                       min="1" 
                                       max="10"
                                       step="1"
                                       value="{{ selected_bhk or '' }}" 
                                       required>
                            </div>
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="bath" class="form-label"><strong>Enter Number Of Bathrooms:</strong></label>
                                <input type="number" 
                                       name="bath" 
                                       id="bath" 
                                       class="form-control" 
                                       placeholder="Enter Number Of Bathrooms" 
                                       min="1" 
                                       max="10"
                                       step="1"
                                       value="{{ selected_bath or '' }}" 
                                       required>
                            </div>
                            <div class="col-md-6">
                                <label for="total_sqft" class="form-label"><strong>Enter Square Feet:</strong></label>
                                <input type="number" 
                                       name="total_sqft" 
                                       id="total_sqft" 
                                       class="form-control" 
                                       placeholder="Enter Square Feet" 
                                       min="500"
                                       max="10000"
                                       step="0.01"
                                       value="{{ selected_sqft or '' }}" 
                                       required>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-lg px-5" {% if not model_loaded %}disabled{% endif %}>
                                üîÆ Predict Price
                            </button>
                            {% if selected_location or selected_bhk or selected_bath or selected_sqft %}
                                <a href="{{ url_for('clear_form') }}" class="btn btn-outline-secondary btn-lg px-4 ms-3">
                                    üóëÔ∏è Clear Form
                                </a>
                            {% endif %}
                        </div>
                    </form>  
                                  </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Clear form function
        function clearForm() {
            document.getElementById('predictionForm').reset();
            // Redirect to clear route to ensure clean state
            window.location.href = "{{ url_for('clear_form') }}";
        }

        // Add form validation
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            const location = document.getElementById('location').value;
            const bhk = document.getElementById('bhk').value;
            const bath = document.getElementById('bath').value;
            const sqft = document.getElementById('total_sqft').value;

            let errors = [];

            if (!location || location === "Choose a location...") {
                errors.push("Please select a location");
            }
            if (!bhk || parseFloat(bhk) <= 0) {
                errors.push("Please enter a valid BHK");
            }
            if (!bath || parseFloat(bath) <= 0) {
                errors.push("Please enter a valid number of bathrooms");
            }
            if (!sqft || parseFloat(sqft) <= 0) {
                errors.push("Please enter a valid square feet value");
            }

            if (errors.length > 0) {
                e.preventDefault();
                alert("Please fix the following errors:\n" + errors.join("\n"));
            }
        });
    </script>
</body>
</html>